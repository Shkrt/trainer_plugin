!function(t){"use strict";function e(t,e,n){var i="",r="";if(n){var o=new Date;o.setTime(o.getTime()+60*n*1e3),i="; expires="+o.toGMTString()}d.domain&&(r="; domain="+d.domain),document.cookie=t+"="+escape(e)+i+r+"; path=/"}function n(t){var e,n,i=t+"=",r=document.cookie.split(";");for(e=0;e<r.length;e++){for(n=r[e];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(i))return unescape(n.substring(i.length,n.length))}return null}function i(t){e(t,"",-1)}function r(e){n("ahoy_debug")&&t.console.log(e)}function o(){for(var t;t=k.shift();)t();p=!0}function a(t){p?t():k.push(t)}function c(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})}function s(){m&&e("ahoy_events",JSON.stringify(_),1)}function u(t){a(function(){m&&x.ajax({type:"POST",url:w,data:JSON.stringify([t]),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){for(var e=0;e<_.length;e++)if(_[e].id==t.id){_.splice(e,1);break}s()}})})}function f(t){var e=x(t.currentTarget);return{tag:e.get(0).tagName.toLowerCase(),id:e.attr("id"),"class":e.attr("class"),page:b,section:e.closest("*[data-section]").data("section")}}var h,g,l,d=t.ahoy||t.Ahoy||{},x=t.jQuery||t.Zepto||t.$,v=240,y=1051200,p=!1,k=[],m="undefined"!=typeof JSON&&"undefined"!=typeof JSON.stringify,_=[],b=d.page||t.location.pathname,T=d.visitsUrl||"/ahoy/visits",w=d.eventsUrl||"/ahoy/events";if(h=n("ahoy_visit"),g=n("ahoy_visitor"),l=n("ahoy_track"),h&&g&&!l)r("Active visit"),o();else if(l&&i("ahoy_track"),h||(h=c(),e("ahoy_visit",h,v)),n("ahoy_visit")){r("Visit started"),g||(g=c(),e("ahoy_visitor",g,y));var S={visit_token:h,visitor_token:g,platform:d.platform||"Web",landing_page:t.location.href,screen_width:t.screen.width,screen_height:t.screen.height};document.referrer.length>0&&(S.referrer=document.referrer),r(S),x.post(T,S,o,"json")}else r("Cookies disabled"),o();d.getVisitId=d.getVisitToken=function(){return h},d.getVisitorId=d.getVisitorToken=function(){return g},d.reset=function(){return i("ahoy_visit"),i("ahoy_visitor"),i("ahoy_events"),i("ahoy_track"),!0},d.debug=function(t){return t===!1?i("ahoy_debug"):e("ahoy_debug","t",525600),!0},d.track=function(t,e){var n={id:c(),name:t,properties:e,time:(new Date).getTime()/1e3};r(n),_.push(n),s(),setTimeout(function(){u(n)},1e3)},d.trackView=function(){var e={url:t.location.href,title:document.title,page:b};d.track("$view",e)},d.trackClicks=function(){x(document).on("click","a, button, input[type=submit]",function(t){var e=x(t.currentTarget),n=f(t);n.text="input"==n.tag?e.val():x.trim(e.text().replace(/[\s\r\n]+/g," ")),n.href=e.attr("href"),d.track("$click",n)})},d.trackSubmits=function(){x(document).on("submit","form",function(t){var e=f(t);d.track("$submit",e)})},d.trackChanges=function(){x(document).on("change","input, textarea, select",function(t){var e=f(t);d.track("$change",e)})},d.trackAll=function(){d.trackView(),d.trackClicks(),d.trackSubmits(),d.trackChanges()};try{_=JSON.parse(n("ahoy_events")||"[]")}catch(O){}for(var V=0;V<_.length;V++)u(_[V]);t.ahoy=d}(window);